<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
</head>
<body>
  <h2>Article RestAPI Test</h2>
  <ul>
    <li><a id="getList" href="/api/articles">목록 조회</a></li>
    <li><a id="get" href="/api/articles/2">2번 조회</a></li>
    <li><a id="post" href="/api/articles">추가</a></li>
    <li><a id="patch" href="/api/articles/2">수정</a></li>
    <li><a id="delete" href="/api/articles/2">삭제</a></li>
  </ul>
  <h3>결과</h3>
  <div id="result" style="margin-bottom:150px"></div>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-ka7Sk0Gln4gmtz2MlQnikT1wXgYsOg+OMhuP+IlRH9sENBO0LRn5q+8nbTov4+1p" crossorigin="anonymous"></script>
  <script>
	  function makeTable(list){
		  let table = '<table class="table table-striped mx-auto" style="width:90%">'	  
		  table += '<tr class="table-dark">'
		  table += '<th>#</th>'
		  table += '<th>Title</th>'
		  table += '<th>Content</th>'
		  table += '</tr>'  

		  list.forEach(function(article){
			  table += '<tr>'
			  table += `<td>${article.id}</td>`
			  table += `<td>${article.title}</td>`
			  table += `<td>${article.content}</td>`
			  table += '</tr>'
		  })
		  table += '</table>';
		  
		  return table;
	  }  
  </script>
  <script>
	  const aEls = document.querySelectorAll('a');
	  const resultEl = document.querySelector('#result');
	  
	  aEls.forEach(function(a){
		  a.onclick = function( event ){
			  event.preventDefault();       // (a,form tag) 의 기본이벤트(href 로 이동하는 것)를 취소
			  event.stopPropagation();      // 이벤트 버블링 중지(a,form 태그이기 때문에 사용. preventDefault랑 셋트로 사용)
			  
			  switch(a.id){
			   case 'getList': 
				   // api controller 실행데이터 받아온다(fetch)
				   fetch(a.href)
				    .then( response => response.json() )
				    .then( list => {
				    	console.log(list);
				    	resultEl.innerHTML = makeTable( list );
				    })
				    .catch( error => console.log(error) )
				   break; 
			  }
		  }
	  })
  </script>
</body>
</html>